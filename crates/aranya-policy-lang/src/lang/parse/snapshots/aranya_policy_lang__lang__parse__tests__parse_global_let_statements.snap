---
source: crates/aranya-policy-lang/src/lang/parse/tests.rs
expression: policy
---
Policy {
    version: V2,
    ffi_imports: [],
    facts: [],
    actions: [
        ActionDefinition {
            persistence: Persistent,
            identifier: Ident {
                name: "foo",
                span: 57..60,
            },
            arguments: [],
            statements: [
                Statement {
                    kind: Let(
                        LetStatement {
                            identifier: Ident {
                                name: "a",
                                span: 81..82,
                            },
                            expression: Expression {
                                kind: Unwrap(
                                    Expression {
                                        kind: FunctionCall(
                                            FunctionCall {
                                                identifier: Ident {
                                                    name: "add",
                                                    span: 92..95,
                                                },
                                                arguments: [
                                                    Expression {
                                                        kind: Identifier(
                                                            Ident {
                                                                name: "x",
                                                                span: 96..97,
                                                            },
                                                        ),
                                                        span: 96..97,
                                                    },
                                                    Expression {
                                                        kind: Int(
                                                            1,
                                                        ),
                                                        span: 99..100,
                                                    },
                                                ],
                                            },
                                        ),
                                        span: 92..101,
                                    },
                                ),
                                span: 85..101,
                            },
                        },
                    ),
                    span: 77..114,
                },
                Statement {
                    kind: Let(
                        LetStatement {
                            identifier: Ident {
                                name: "c",
                                span: 118..119,
                            },
                            expression: Expression {
                                kind: Not(
                                    Expression {
                                        kind: Identifier(
                                            Ident {
                                                name: "z",
                                                span: 123..124,
                                            },
                                        ),
                                        span: 123..124,
                                    },
                                ),
                                span: 122..124,
                            },
                        },
                    ),
                    span: 114..137,
                },
                Statement {
                    kind: Emit(
                        Expression {
                            kind: NamedStruct(
                                NamedStruct {
                                    identifier: Ident {
                                        name: "Bar",
                                        span: 142..145,
                                    },
                                    fields: [
                                        (
                                            Ident {
                                                name: "a",
                                                span: 164..165,
                                            },
                                            Expression {
                                                kind: Identifier(
                                                    Ident {
                                                        name: "a",
                                                        span: 167..168,
                                                    },
                                                ),
                                                span: 167..168,
                                            },
                                        ),
                                        (
                                            Ident {
                                                name: "c",
                                                span: 186..187,
                                            },
                                            Expression {
                                                kind: Identifier(
                                                    Ident {
                                                        name: "c",
                                                        span: 189..190,
                                                    },
                                                ),
                                                span: 189..190,
                                            },
                                        ),
                                    ],
                                    sources: [],
                                },
                            ),
                            span: 142..205,
                        },
                    ),
                    span: 137..214,
                },
            ],
            span: 50..215,
        },
    ],
    effects: [],
    structs: [],
    enums: [],
    commands: [],
    functions: [],
    finish_functions: [],
    global_lets: [
        GlobalLetStatement {
            identifier: Ident {
                name: "x",
                span: 13..14,
            },
            expression: Expression {
                kind: Int(
                    42,
                ),
                span: 17..19,
            },
            span: 9..28,
        },
        GlobalLetStatement {
            identifier: Ident {
                name: "z",
                span: 32..33,
            },
            expression: Expression {
                kind: Bool(
                    true,
                ),
                span: 36..40,
            },
            span: 28..50,
        },
    ],
    text: "\n        let x = 42\n        let z = true\n\n        action foo() {\n            let a = unwrap add(x, 1)\n            let c = !z\n            emit Bar {\n                a: a,\n                c: c,\n            }\n        }\n    ",
}
